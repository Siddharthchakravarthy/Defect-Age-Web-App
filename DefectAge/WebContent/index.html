<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script src = "https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
</head>
<body>
	<div align = "center">
		<div> <h2>This is the file  </h2> </div>
	</div>
	<input type = "file" id ="input">
	<table id = "tableData"></table>
</body>
<script>
	var input = document.getElementById('input');
	input.addEventListener('change', function() {
		readXlsxFile(input.files[0]).then(function(data) {
			var i = 0;
			data.map((row, index) => {
				if(i == 0) {
					let table = document.getElementById("tableData");
					generateTableHead(table, row);
				}
				
				if(i > 0) {
					let table = document.getElementById("tableData");
					generateTableRows(table, row);
				}	
				i++;
			});
		});
	});
	
	function generateTableHead(table, data) {
		let thead = table.createTHead();
		let row = thead.insertRow();
		
		for(let key of data) {
			let th = document.createElement("th");
			let text = document.createTextNode(key);
			th.appendChild(text);
			row.appendChild(th);
		}
	}
	
	function generateTableRows(table, data) {
		let newRow = table.insertRow(-1);
		data.map((row, index) => {
			let newCell = newRow.insertCell();
			let newText = document.createTextNode(row);
			newCell.appendChild(newText);
		});
	}
	
	
</script>
</html>